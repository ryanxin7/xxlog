<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.60" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html"><meta property="og:site_name" content="Ryan's Notebook"><meta property="og:title" content="8.RGW对象存储网关"><meta property="og:description" content="Ceph中独立的服务如果不用可以不启用。 类似阿里云OSS对象存储。遵循亚马逊S3标准数据存在bucket中 官方文档：http:/docs.ceph.org.cn/radosgw/数据不需要放置在目录层次结构中，而是存在于平面地址空间内的同一级别，应用通过唯一地址来识别每个单独数据对象。访问的时候传递的URL是固定的。每个对象可包含有助于检索的元数据通过RESTful API在应用级别(而非用户级别)进行访问 image.png"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-05-02T00:25:35.000Z"><meta property="article:tag" content="分布式存储"><meta property="article:published_time" content="2023-01-07T12:12:22.000Z"><meta property="article:modified_time" content="2023-05-02T00:25:35.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"8.RGW对象存储网关","image":[""],"datePublished":"2023-01-07T12:12:22.000Z","dateModified":"2023-05-02T00:25:35.000Z","author":[]}</script><title>8.RGW对象存储网关 | Ryan's Notebook</title><meta name="description" content="Ceph中独立的服务如果不用可以不启用。 类似阿里云OSS对象存储。遵循亚马逊S3标准数据存在bucket中 官方文档：http:/docs.ceph.org.cn/radosgw/数据不需要放置在目录层次结构中，而是存在于平面地址空间内的同一级别，应用通过唯一地址来识别每个单独数据对象。访问的时候传递的URL是固定的。每个对象可包含有助于检索的元数据通过RESTful API在应用级别(而非用户级别)进行访问 image.png">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-e9ac4e0d.css" as="style"><link rel="stylesheet" href="/assets/style-e9ac4e0d.css">
    <link rel="modulepreload" href="/assets/app-982fbdc9.js"><link rel="modulepreload" href="/assets/framework-8eb1d601.js"><link rel="modulepreload" href="/assets/8. 对象存储网关RGW.html-3f46198e.js"><link rel="modulepreload" href="/assets/8. 对象存储网关RGW.html-7bd9e5ad.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="Ryan&#39;s Notebook"><!----><span class="site-name hide-in-pad">Ryan&#39;s Notebook</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="濼鑫的知识库"><span class="font-icon icon iconfont icon-home" style=""></span>濼鑫的知识库<!----></a></div><div class="nav-item hide-in-mobile"><a href="/category/" class="nav-link" aria-label="归档🗂️"><span class="font-icon icon iconfont icon-beaker" style=""></span>归档🗂️<!----></a></div><div class="nav-item hide-in-mobile"><a href="/article/" class="nav-link" aria-label="文章🌱"><span class="font-icon icon iconfont icon-beaker" style=""></span>文章🌱<!----></a></div><div class="nav-item hide-in-mobile"><a href="/timeline/" class="nav-link" aria-label="时间线⏰"><span class="font-icon icon iconfont icon-beaker" style=""></span>时间线⏰<!----></a></div><div class="nav-item hide-in-mobile"><a href="/about/" class="nav-link" aria-label="关于🤷"><span class="font-icon icon iconfont icon-beaker" style=""></span>关于🤷<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="小记📌"><span class="title"><!---->小记📌</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>小记</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/xj/" class="nav-link" aria-label="一些知识的碎片🌠"><span class="font-icon icon iconfont icon-exercise" style=""></span>一些知识的碎片🌠<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>常用工具</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://imageresizer.com/" rel="noopener noreferrer" target="_blank" aria-label="图片压缩" class="nav-link"><span class="font-icon icon iconfont icon-more" style=""></span>图片压缩<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-subitem"><a href="https://www.flaticon.com/" rel="noopener noreferrer" target="_blank" aria-label="免费图标素材" class="nav-link"><span class="font-icon icon iconfont icon-more" style=""></span>免费图标素材<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-subitem"><a href="https://emojipedia.org/" rel="noopener noreferrer" target="_blank" aria-label="emojipedia" class="nav-link"><span class="font-icon icon iconfont icon-more" style=""></span>emojipedia<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/ryanxin7/xxlog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">搜索</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/ceph/" class="nav-link sidebar-link sidebar-page" aria-label="Ceph"><!---->Ceph<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading active"><!----><span class="title"></span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/ceph/log/1.Ceph%E7%AE%80%E4%BB%8B.html" class="nav-link sidebar-link sidebar-page" aria-label="1.Ceph 简介"><!---->1.Ceph 简介<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/ceph/log/3.Ceph-FS%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8.html" class="nav-link sidebar-link sidebar-page" aria-label="3.Ceph-FS 文件存储"><!---->3.Ceph-FS 文件存储<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/ceph/log/4.Ceph%E9%9B%86%E7%BE%A4%E7%BB%B4%E6%8A%A4.html" class="nav-link sidebar-link sidebar-page" aria-label="4.Ceph 集群维护"><!---->4.Ceph 集群维护<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/ceph/log/5.%20CephX%E8%AE%A4%E8%AF%81%E6%9C%BA%E5%88%B6.html" class="nav-link sidebar-link sidebar-page" aria-label="5.CephX 认证机制"><!---->5.CephX 认证机制<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/ceph/log/6.%20Ceph-RBD%E4%BD%BF%E7%94%A8.html" class="nav-link sidebar-link sidebar-page" aria-label="6.Ceph RBD"><!---->6.Ceph RBD<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/ceph/log/7.%20Ceph-FS%E4%BD%BF%E7%94%A8.html" class="nav-link sidebar-link sidebar-page" aria-label="7.Ceph FS"><!---->7.Ceph FS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="8.RGW对象存储网关"><!---->8.RGW对象存储网关<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-1-radosgw对象存储简介" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.1 RadosGW对象存储简介"><!---->8.1 RadosGW对象存储简介<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-2-对象存储特点" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.2 对象存储特点"><!---->8.2 对象存储特点<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-2-1-bucket-特性" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.2.1 bucket 特性"><!---->8.2.1 bucket 特性<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-2-2-bucket命名规范" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.2.2 bucket命名规范"><!---->8.2.2 bucket命名规范<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-3-对象存储访问对比" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.3 对象存储访问对比"><!---->8.3 对象存储访问对比<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-部署radosgw服务" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.4 部署RadosGW服务"><!---->8.4 部署RadosGW服务<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-1-安装radosgw服务并初始化" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.4.1 安装radosgw服务并初始化"><!---->8.4.1 安装radosgw服务并初始化<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-2-验证radosgw服务状态" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.4.2 验证radosgw服务状态"><!---->8.4.2 验证radosgw服务状态<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-3-验证radosgw服务进程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.4.3 验证radosgw服务进程"><!---->8.4.3 验证radosgw服务进程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-4-radosgw的存储池类型" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.4.4 radosgw的存储池类型"><!---->8.4.4 radosgw的存储池类型<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-5-rgw存储池功能" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.4.5 RGW存储池功能"><!---->8.4.5 RGW存储池功能<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-6-验证rgw-zone信息" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.4.6 验证RGW zone信息"><!---->8.4.6 验证RGW zone信息<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-5-radosgw服务高可用配置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.5 radosgw服务高可用配置"><!---->8.5 radosgw服务高可用配置<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-5-1-radosgw-http高可用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.5.1 radosgw http高可用"><!---->8.5.1 radosgw http高可用<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-5-2-radosgw-https" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.5.2 radosgw https"><!---->8.5.2 radosgw https<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-5-3-radosgw-https高可用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.5.3 radosgw https高可用"><!---->8.5.3 radosgw https高可用<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-5-4-日志及其它优化配置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.5.4 日志及其它优化配置"><!---->8.5.4 日志及其它优化配置<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-6-测试数据读写" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.6 测试数据读写"><!---->8.6 测试数据读写<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-6-2-创建rgw-账号" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.6.2 创建RGW 账号"><!---->8.6.2 创建RGW 账号<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-6-3-安装s3cmd客户端" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.6.3 安装s3cmd客户端"><!---->8.6.3 安装s3cmd客户端<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-6-4-配置客户端执行环境" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.6.4 配置客户端执行环境"><!---->8.6.4 配置客户端执行环境<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-6-5-命令行客户端s3cmd-验证数据上传" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.6.5 命令行客户端s3cmd 验证数据上传"><!---->8.6.5 命令行客户端s3cmd 验证数据上传<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/ceph/log/9.%20ceph-crush%E8%BF%9B%E9%98%B6.html" class="nav-link sidebar-link sidebar-page" aria-label="9.Ceph crush算法进阶"><!---->9.Ceph crush算法进阶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/ceph/log/10.%20ceph-dashboard%E5%8F%8A%E7%9B%91%E6%8E%A7.html" class="nav-link sidebar-link sidebar-page" aria-label="10.Ceph Dashboard及监控"><!---->10.Ceph Dashboard及监控<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->8.RGW对象存储网关</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="http://ryanxin.live" target="_blank" rel="noopener noreferrer">Ryan</a></span><span property="author" content="Ryan"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-01-07T12:12:22.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 13 分钟</span><meta property="timeRequired" content="PT13M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category6 clickable" role="navigation">Ceph</span><meta property="articleSection" content="Ceph"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="page-tag-item tag7 clickable" role="navigation">分布式存储</span><meta property="keywords" content="分布式存储"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button class="print-button" title="print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-1-radosgw对象存储简介" class="router-link-active router-link-exact-active toc-link level3">8.1 RadosGW对象存储简介</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-2-对象存储特点" class="router-link-active router-link-exact-active toc-link level2">8.2 对象存储特点</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-2-1-bucket-特性" class="router-link-active router-link-exact-active toc-link level3">8.2.1 bucket 特性</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-2-2-bucket命名规范" class="router-link-active router-link-exact-active toc-link level3">8.2.2 bucket命名规范</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-3-对象存储访问对比" class="router-link-active router-link-exact-active toc-link level3">8.3 对象存储访问对比</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-部署radosgw服务" class="router-link-active router-link-exact-active toc-link level2">8.4 部署RadosGW服务</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-1-安装radosgw服务并初始化" class="router-link-active router-link-exact-active toc-link level3">8.4.1 安装radosgw服务并初始化</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-2-验证radosgw服务状态" class="router-link-active router-link-exact-active toc-link level3">8.4.2 验证radosgw服务状态</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-3-验证radosgw服务进程" class="router-link-active router-link-exact-active toc-link level3">8.4.3 验证radosgw服务进程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-4-radosgw的存储池类型" class="router-link-active router-link-exact-active toc-link level3">8.4.4 radosgw的存储池类型</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-5-rgw存储池功能" class="router-link-active router-link-exact-active toc-link level3">8.4.5 RGW存储池功能</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-4-6-验证rgw-zone信息" class="router-link-active router-link-exact-active toc-link level3">8.4.6 验证RGW zone信息</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-5-radosgw服务高可用配置" class="router-link-active router-link-exact-active toc-link level2">8.5 radosgw服务高可用配置</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-5-1-radosgw-http高可用" class="router-link-active router-link-exact-active toc-link level3">8.5.1 radosgw http高可用</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-5-2-radosgw-https" class="router-link-active router-link-exact-active toc-link level3">8.5.2 radosgw https</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-5-3-radosgw-https高可用" class="router-link-active router-link-exact-active toc-link level3">8.5.3 radosgw https高可用</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-5-4-日志及其它优化配置" class="router-link-active router-link-exact-active toc-link level3">8.5.4 日志及其它优化配置</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-6-测试数据读写" class="router-link-active router-link-exact-active toc-link level2">8.6 测试数据读写</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-6-2-创建rgw-账号" class="router-link-active router-link-exact-active toc-link level3">8.6.2 创建RGW 账号</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-6-3-安装s3cmd客户端" class="router-link-active router-link-exact-active toc-link level3">8.6.3 安装s3cmd客户端</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-6-4-配置客户端执行环境" class="router-link-active router-link-exact-active toc-link level3">8.6.4 配置客户端执行环境</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/ceph/log/8.%20%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%BD%91%E5%85%B3RGW.html#_8-6-5-命令行客户端s3cmd-验证数据上传" class="router-link-active router-link-exact-active toc-link level3">8.6.5 命令行客户端s3cmd 验证数据上传</a></li><!----><!--]--></ul><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><p>Ceph中独立的服务如果不用可以不启用。 类似阿里云OSS对象存储。遵循亚马逊S3标准数据存在bucket中</p><p>官方文档：<code>http:/docs.ceph.org.cn/radosgw/</code><br>数据不需要放置在目录层次结构中，而是存在于平面地址空间内的同一级别，<br>应用通过唯一地址来识别每个单独数据对象。访问的时候传递的URL是固定的。<br>每个对象可包含有助于检索的元数据通过<strong>RESTful API</strong>在应用级别(而非用户级别)进行访问</p><figure><img src="http://cdn1.ryanxin.live/xxlog/1670115995731-8365768d-7000-4b53-bb69-720c439963c1.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><figure><img src="http://cdn1.ryanxin.live/xxlog/1670116247558-c32d04a1-0d4b-49f5-af1a-32badd4bbf66.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="_8-1-radosgw对象存储简介" tabindex="-1"><a class="header-anchor" href="#_8-1-radosgw对象存储简介" aria-hidden="true">#</a> 8.1 RadosGW对象存储简介</h3><p><strong>RadosGW</strong>是对象存储(<strong>OSS,Object Storage Service</strong>)的一种实现方式，** RADOS<strong>网关也称为Ceph对象网关、<strong>RadosGW、RGW</strong>,是-种服务， 使客户端能够利用标准对象存储API来访问Ceph集群，它支持</strong>AWSS3<strong>和</strong>SwiftAPI**，在ceph0.8版本之后使用<strong>Civetweb</strong>(<a href="https://github.com/civetweb/civetweb" target="_blank" rel="noopener noreferrer">https://github.com/civetweb/civetweb)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>)的web服务器来响应api请求，客户端使用<strong>http/https</strong>协议通过<strong>RESTful API</strong>与<strong>RGW</strong>通信默认端口7480，而RGW则通过<strong>librados</strong>与ceph集群通信，RGW客户端通过s3或者swift api使用RGW用户进行身份验证，然后RGW网关代表用户利用cephx与ceph存储进行身份验证.<br>S3由Amazon于2006年推出，全称为Simple Storage Service,S3定义了对象存储，是对象存储事实上的标准，从某种意义上说，S3 就是对象存储，对象存储就是S3,它是对象存储市场的霸主，后续的对象存储都是对S3的模仿。</p><figure><img src="http://cdn1.ryanxin.live/xxlog/1670119694230-3d7210c2-0667-49ee-a769-8842df34eb41.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h2 id="_8-2-对象存储特点" tabindex="-1"><a class="header-anchor" href="#_8-2-对象存储特点" aria-hidden="true">#</a> 8.2 对象存储特点</h2><p><strong>通过对象存储将数据存储为对象，每个对象除了包含数据，还包含数据自身的元数据。</strong></p><ol><li><p>对象通过<strong>Object ID</strong>来检索，无法通过普通文件系统的方式通过文件路径及文件名称操作来直接访问对象，只能通过API来访问，或者第三方客户端(实际上也是对API的封装)。</p></li><li><p>对象存储中的对象不整理到目录树中，而是存储在扁平的命名空间中，Amazon S3将这个扁平命名空间称为<strong>bucket</strong>,而swift则将其称为容器。无论是bucket还是容器，都不能嵌套。</p></li><li><p>bucket需要被授权才能访问到，一个帐户可以对多个bucket授权，而权限可以不同。方便横向扩展、快速检索数据。</p></li><li><p>不支持客户端挂载，且需要客户端在访问的时候指定文件名称。不是很适用于文件过于频繁修改及删除的场景。</p></li><li><p><strong>ceph</strong>使用<strong>bucket</strong>作为存储桶(存储空间)，实现对象数据的存储和多用户隔离，数据存储在bucket中，用户的权限也是针对bucket进行授权，可以设置用户对不同的bucket拥有不同的权限，以实现权限管理。</p></li></ol><p>基于bucket对项目隔离</p><p>对象存储运维需要做的事情：<br>启用RGW<br>做好RGW的高可用<br>创建bucket<br>创建用户并授权<br>做好监控</p><h3 id="_8-2-1-bucket-特性" tabindex="-1"><a class="header-anchor" href="#_8-2-1-bucket-特性" aria-hidden="true">#</a> 8.2.1 bucket 特性</h3><p><strong>存储空间是用于存储对象(Object) 的容器</strong>，所有的对象都必须隶属于某个存储空间，可以设置和修改存储空间属性用来控制地域、访问权限、生命周期等，这些属性设置直接作用于该存储空间内所有对象，因此可以通过灵活创建不同的存储空间来完成不同的管理功能。</p><p>同一个存储空间的内部是扁平的，没有文件系统的目录等概念，所有的对象都直接隶属于其对应的存储空间。</p><p>每个用户可以拥有多个存储空间</p><p>存储空间的名称在OSS范围内必须是全局唯一的，一旦创建之后无法修改名称。</p><p>存储空间内部的对象数目没有限制。</p><h3 id="_8-2-2-bucket命名规范" tabindex="-1"><a class="header-anchor" href="#_8-2-2-bucket命名规范" aria-hidden="true">#</a> 8.2.2 bucket命名规范</h3><p><a href="https://docs.amazonaws.cn/AmazonS3/latest/userguide/bucketnamingrules.html" target="_blank" rel="noopener noreferrer">https://docs.amazonaws.cn/AmazonS3/latest/userguide/bucketnamingrules.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li>只能包括小写字母、数字和短横线(-)</li><li>必须以小写字母或者数字开头和结尾.</li><li>长度必须在3-63字节之间。</li><li>存储桶名称不能使用用IP地址格式.</li><li>Bucket名称必须全局唯一</li></ul><figure><img src="http://cdn1.ryanxin.live/xxlog/1670120818609-bec75cff-4423-45e6-bb82-48d409f94331.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><figure><img src="http://cdn1.ryanxin.live/xxlog/1670120832980-020b94b7-78bc-40f0-8711-0b3b5ab2ffb9.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="_8-3-对象存储访问对比" tabindex="-1"><a class="header-anchor" href="#_8-3-对象存储访问对比" aria-hidden="true">#</a> 8.3 对象存储访问对比</h3><p>目前主流有三种访问标准：</p><p><strong>AmEizon S3</strong>:提供了user、bucket 和object分别表示用户、存储桶和对象，其中bucket<br>隶属于user,可以针对user设置不同bucket的名称空间的访问权限，而且不同用户允许访问相同的bucket。<br>（使用最多-最广泛）</p><p><strong>OpenStack Swift</strong>:提供了user、 container 和object分别对应于用户、存储桶和对象，不过它还额外为user提供了父级组件account, account用于表示一个项目或租户(OpenStack用户)，因此一个account中可包含一到多个user,它们可共享使用同一组 container, 并为container提供名称空间。</p><p><strong>RadosGW</strong>: 提供了user、 subuser、bucket 和object,其中的user对应于S3的user,而subuser则对应于Swift的user,不过user和subuser都不支持为bucket提供名称空间，<br>因此，不同用户的存储桶也不允许同名;不过，自Jewel版本起，RadosGW引入了tenant(租户)用于为user和bucket提供名称空间，但它是个可选组件，RadosGW 基于ACL为不同的用户设置不同的权限控制，如:<br>Read读权限<br>Write写权限<br>Readwrite读写权限<br>full-control全部控制权限</p><h2 id="_8-4-部署radosgw服务" tabindex="-1"><a class="header-anchor" href="#_8-4-部署radosgw服务" aria-hidden="true">#</a> 8.4 部署RadosGW服务</h2><p>将ceph-mgr1、ceph-mgr2 服务器部署为高可用的radosGW服务</p><h3 id="_8-4-1-安装radosgw服务并初始化" tabindex="-1"><a class="header-anchor" href="#_8-4-1-安装radosgw服务并初始化" aria-hidden="true">#</a> 8.4.1 安装radosgw服务并初始化</h3><p><strong>Ubuntu</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#apt install radosgw</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>CentOS</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@ceph-mgr1 ~<span class="token punctuation">]</span><span class="token comment"># yum install ceph-radosgw</span>
<span class="token punctuation">[</span>root@ceph-mgr2 ~<span class="token punctuation">]</span><span class="token comment"># yum install ceph-radosgw</span>

<span class="token comment">#在ceph deploy服务器将ceph-mgr1初始化为radosGW服务:</span>
<span class="token punctuation">[</span>ceph@ceph-deploy ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">cd</span> ceph-cluster/
<span class="token punctuation">[</span>ceph@ceph-deploy ceph-cluster<span class="token punctuation">]</span>$ ceph-deploy rgw create ceph-mgr2
<span class="token punctuation">[</span>ceph@ceph-deploy ceph-cluster<span class="token punctuation">]</span>$ ceph-deploy rgw create ceph-mgr1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-4-2-验证radosgw服务状态" tabindex="-1"><a class="header-anchor" href="#_8-4-2-验证radosgw服务状态" aria-hidden="true">#</a> 8.4.2 验证radosgw服务状态</h3><figure><img src="http://cdn1.ryanxin.live/xxlog/1670121760972-179031b2-cd45-4060-8484-5f88dc719934.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="_8-4-3-验证radosgw服务进程" tabindex="-1"><a class="header-anchor" href="#_8-4-3-验证radosgw服务进程" aria-hidden="true">#</a> 8.4.3 验证radosgw服务进程</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> radosgw
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_8-4-4-radosgw的存储池类型" tabindex="-1"><a class="header-anchor" href="#_8-4-4-radosgw的存储池类型" aria-hidden="true">#</a> 8.4.4 radosgw的存储池类型</h3><p>启动radosgw 服务自动创建default zone区域存储池，这些存储池的功能是不一样的</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>root@ceph-deploy:~<span class="token comment"># ceph osd pool ls</span>
device_health_metrics
cephfs-metadata
cephfs-data
.rgw.root
default.rgw.log
default.rgw.control
default.rgw.meta
default.rgw.buckets.index
default.rgw.buckets.data

root@ceph-deploy:~<span class="token comment"># ceph osd pool get default.rgw.buckets.data crush_rule</span>
crush_rule: replicated_rule <span class="token comment">#默认是副本池</span>

root@ceph-deploy:~<span class="token comment"># ceph osd pool get default.rgw.buckets.data size</span>
size: <span class="token number">3</span> <span class="token comment">#默认的副本数</span>

root@ceph-deploy:~<span class="token comment"># ceph osd pool get default.rgw.buckets.data pgp_num</span>
pgp_num: <span class="token number">32</span> <span class="token comment">#默认的pgp数量</span>
root@ceph-deploy:~<span class="token comment"># ceph osd pool get default.rgw.buckets.data pg_num</span>
pg_num: <span class="token number">32</span> <span class="token comment">#默认的pg数量</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-4-5-rgw存储池功能" tabindex="-1"><a class="header-anchor" href="#_8-4-5-rgw存储池功能" aria-hidden="true">#</a> 8.4.5 RGW存储池功能</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>root@ceph-deploy:~ <span class="token comment"># ceph osd lspools</span>
<span class="token number">1</span> device_health_metrics
<span class="token number">3</span> cephfs-metadata
<span class="token number">4</span> cephfs-data
<span class="token number">9</span>.rgw.root
<span class="token number">10</span> default.rgw.log
<span class="token number">11</span> default.rgw.control
<span class="token number">12</span> default.rgw.meta
<span class="token number">13</span> default.rgw.buckets.index
<span class="token number">14</span> default.rgw.buckets.data
<span class="token number">15</span> default.rgw.buckets.non-ec
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>.rgw.root</code>: 包含 realm(领域信息)，比如<strong>zone</strong>和<strong>zonegroup</strong>。（用于不同区域多机房之间）<br>default.rgw.log: 存储日志信息，用于记录各种log信息。<br><code>default.rgw.control</code>: 系统控制池，在有数据更新时，通知其它RGW更新缓存。<br><code>default.rgw.meta</code>: 元数据存储池，通过不同的名称空间分别存储不同的rados对象，这<br>些名称空间包括<strong>用户UID</strong>及其bucket映射信息的名称空间<strong>users.uid</strong>、用户的密钥名称空间<br><strong>users.keys</strong>、用戶的email名称空间<strong>users.email</strong>、用户的subuser的名称空间<strong>users. swift</strong><br>、以及<strong>bucket</strong>的名称空间<strong>root</strong>等。<br><code>default.rgw.buckets.index</code>: 存放 bucket到object的索引信息。<br><code>default.rgw.buckets.data</code>: 存放对象的数据 。<br><code>default.rgw. buckets.non-ec</code> ：数据的额外信息存储池。</p><h3 id="_8-4-6-验证rgw-zone信息" tabindex="-1"><a class="header-anchor" href="#_8-4-6-验证rgw-zone信息" aria-hidden="true">#</a> 8.4.6 验证RGW zone信息 <br><br></h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>root@ceph-deploy:~<span class="token comment"># radosgw-admin zone get --rgw-zone=default</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_8-5-radosgw服务高可用配置" tabindex="-1"><a class="header-anchor" href="#_8-5-radosgw服务高可用配置" aria-hidden="true">#</a> 8.5 radosgw服务高可用配置</h2><figure><img src="http://cdn1.ryanxin.live/xxlog/1670125550434-c8a038af-8737-4c7b-9458-790da79c1582.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="_8-5-1-radosgw-http高可用" tabindex="-1"><a class="header-anchor" href="#_8-5-1-radosgw-http高可用" aria-hidden="true">#</a> 8.5.1 radosgw http高可用</h3><h4 id="_8-5-1-1-自定义http端口" tabindex="-1"><a class="header-anchor" href="#_8-5-1-1-自定义http端口" aria-hidden="true">#</a> 8.5.1.1 自定义http端口</h4><p>配置文件可以在ceph deploy服务器修改然后统一推送，或者单独修改每个radosgw服务器的配置为统一配置，然后重启RGW服务。</p><p><a href="https://docs" target="_blank" rel="noopener noreferrer">https://docs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. <a href="http://ceph.com/en/latest/radosaw/frontends/" target="_blank" rel="noopener noreferrer">ceph.com/en/latest/radosaw/frontends/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><br>[链接](<a href="https://docs" target="_blank" rel="noopener noreferrer">https://docs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. <a href="http://ceph.com/en/latest/radosaw/frontends/" target="_blank" rel="noopener noreferrer">ceph.com/en/latest/radosaw/frontends/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>)</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@ceph-mgr2 ~<span class="token punctuation">]</span><span class="token comment"># vim /etc/ceph/ceph.conf</span>
<span class="token punctuation">[</span>client.rgw.ceph-mgr2<span class="token punctuation">]</span> <span class="token comment">#在最后面添加针对当前节点的自定义配置如下:</span>
<span class="token assign-left variable">rgw_host</span><span class="token operator">=</span>ceph-mgr2
<span class="token assign-left variable">rrgw_frontends</span><span class="token operator">=</span>civetweb <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">9900</span>
<span class="token comment">#重启服务</span>
<span class="token punctuation">[</span>root@ceph-mgr2 ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart ceph-radosgw@rgw.ceph-mgr2.service</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="http://cdn1.ryanxin.live/xxlog/1670132303596-46c8cb2e-5090-49da-bd8a-21ba8b7cf6f6.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h4 id="_8-5-1-3-测试http反向代理" tabindex="-1"><a class="header-anchor" href="#_8-5-1-3-测试http反向代理" aria-hidden="true">#</a> 8.5.1.3 测试http反向代理</h4><p>使用haproxy代理 rgw两个节点</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum <span class="token function">install</span> haproxy 

<span class="token function">vim</span> /etc/haproxy/haproxy.cfg



listen ceph-rgw 
  <span class="token builtin class-name">bind</span> <span class="token number">172.31</span>.6.201:80
  mode tcp
  server rgw1 <span class="token number">172.31</span>.6.104:7480 check inter 3s fall <span class="token number">3</span> rise <span class="token number">5</span>
  server rgw2 <span class="token number">172.31</span>.6.105:7480 check inter 3s fall <span class="token number">3</span> rise <span class="token number">5</span>

systemctl restart haproxy.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="http://cdn1.ryanxin.live/xxlog/1670132456616-18c0f457-d9f4-4b0f-abb0-66ab5b3e7e46.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="_8-5-2-radosgw-https" tabindex="-1"><a class="header-anchor" href="#_8-5-2-radosgw-https" aria-hidden="true">#</a> 8.5.2 radosgw https</h3><p>在rgw节点生成签名证书并配置radosgw启用SSL<br><strong>方式一： 在反向代理配置SSL证书</strong><br><strong>方式二： 内置自签证书（浏览器提升不安全证书）</strong></p><h4 id="_8-5-2-1-自签名证书" tabindex="-1"><a class="header-anchor" href="#_8-5-2-1-自签名证书" aria-hidden="true">#</a> 8.5.2.1 自签名证书</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@ceph-mgr2 ~<span class="token punctuation">]</span><span class="token comment"># cd /etc/ceph/</span>
<span class="token punctuation">[</span>root@ceph-mgr2 ceph<span class="token punctuation">]</span><span class="token comment"># mkdir certs</span>
<span class="token punctuation">[</span>root@ceph-mgr2 ceph<span class="token punctuation">]</span><span class="token comment"># cd certs/</span>
<span class="token comment">#生成key</span>
root@ceph-mgr2 certs<span class="token punctuation">]</span><span class="token comment"># openssl genrsa -out civetweb.key 2048</span>

<span class="token comment">#自签发</span>
<span class="token punctuation">[</span>root@ceph-mgr2 certs<span class="token punctuation">]</span><span class="token comment"># openssl req -new -x509 -key civetweb.key -out civetweb.crt -subj &quot;/CN=rgw.magedu.net&quot;</span>
<span class="token comment">#将key和私钥放一块</span>
<span class="token punctuation">[</span>root@ceph-mgr2 certs<span class="token punctuation">]</span><span class="token comment"># cat civetweb.key civetweb.crt &gt; civetweb.pem</span>
<span class="token punctuation">[</span>root@ceph-mgr2 certs<span class="token punctuation">]</span><span class="token comment"># tree</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-5-2-2-ssl配置" tabindex="-1"><a class="header-anchor" href="#_8-5-2-2-ssl配置" aria-hidden="true">#</a> 8.5.2.2 SSL配置</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@ceph-mgr2 certs<span class="token punctuation">]</span><span class="token comment"># vim /etc/ceph/ceph.conf</span>
<span class="token punctuation">[</span>client.rgw.ceph-mgr2<span class="token punctuation">]</span>
rgw_host <span class="token operator">=</span> ceph-mgr2
rgw_frontends <span class="token operator">=</span>  <span class="token string">&quot;civetweb port-9900+9443s ssl_certificate=/etc/ceph/certs/civetweb.pem&quot;</span>
root@ceph-mgr2 certs<span class="token punctuation">]</span><span class="token comment"># systemctl restart ceph-radosgw@rgw.ceph-mgr2.service</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-5-2-3-验证https端口" tabindex="-1"><a class="header-anchor" href="#_8-5-2-3-验证https端口" aria-hidden="true">#</a> 8.5.2.3 验证https端口</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ss <span class="token parameter variable">-tnl</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_8-5-3-radosgw-https高可用" tabindex="-1"><a class="header-anchor" href="#_8-5-3-radosgw-https高可用" aria-hidden="true">#</a> 8.5.3 radosgw https高可用</h3><p>通过负载均衡对radosgw进行反向代理，实现高可用</p><h4 id="_8-5-3-1-域名解析至vip" tabindex="-1"><a class="header-anchor" href="#_8-5-3-1-域名解析至vip" aria-hidden="true">#</a> 8.5.3.1 域名解析至VIP</h4><p>先将域名解析至负裁均衡的IP<br>172.31.6.201 <a href="http://rgw.magedu.net" target="_blank" rel="noopener noreferrer">rgw.magedu.net<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="_8-5-3-2-负载均衡配置" tabindex="-1"><a class="header-anchor" href="#_8-5-3-2-负载均衡配置" aria-hidden="true">#</a> 8.5.3.2 负载均衡配置</h4><p>负载均衡配置监听及realserver ,把SSL证书放在了rgw节点上面（也放在负载均衡上面）</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#ceph http access</span>
listen ceph-rgw
<span class="token builtin class-name">bind</span> <span class="token number">172.31</span>.6.201:80
mode tcp
server <span class="token number">172.31</span>.6.104 <span class="token number">172.31</span>.6.104:9900 check inter 3s fall <span class="token number">3</span> rise <span class="token number">5</span>
server <span class="token number">172.31</span>.6.105 <span class="token number">172.31</span>.6.105:9900 check inter 3s fall <span class="token number">3</span> rise <span class="token number">5</span> 


<span class="token comment">#ceph https access</span>
listen ceph-rgw
<span class="token builtin class-name">bind</span> <span class="token number">172.31</span>.6.201:443
mode tcp
server <span class="token number">172.31</span>.6.104 <span class="token number">172.31</span> .6.104:9443 check inter 3s fall <span class="token number">3</span> rise <span class="token number">5</span>
server <span class="token number">172.31</span>.6.105 <span class="token number">172.31</span> .6.105:9443 check inter 3s fall <span class="token number">3</span> rise <span class="token number">5</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-5-3-3-重启负载均衡" tabindex="-1"><a class="header-anchor" href="#_8-5-3-3-重启负载均衡" aria-hidden="true">#</a> 8.5.3.3 重启负载均衡</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@ceph-client1-centos7 ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart haproxy</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_8-5-3-4-测试访问" tabindex="-1"><a class="header-anchor" href="#_8-5-3-4-测试访问" aria-hidden="true">#</a> 8.5.3.4 测试访问</h4><h3 id="_8-5-4-日志及其它优化配置" tabindex="-1"><a class="header-anchor" href="#_8-5-4-日志及其它优化配置" aria-hidden="true">#</a> 8.5.4 日志及其它优化配置 <br><br></h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#创建日志目录:</span>
<span class="token punctuation">[</span>root@ceph-mgr2 certs<span class="token punctuation">]</span><span class="token comment"># mkdir /var/log/radosgw</span>
<span class="token punctuation">[</span>root@ceph-mgr2 certs<span class="token punctuation">]</span><span class="token comment"># chown ceph.ceph /var/log/radosgw</span>


<span class="token comment">#当前配置</span>
<span class="token punctuation">[</span>root@ceph-mgr2 ceph<span class="token punctuation">]</span><span class="token comment"># vim ceph.conf</span>
<span class="token punctuation">[</span>client.rgw.ceph-mgr2<span class="token punctuation">]</span>
rgw_host <span class="token operator">=</span> ceph-mgr2
rgw_frontends <span class="token operator">=</span> <span class="token string">&quot;civetweb port=9900+8443s
ssl_certificate=/etc/ceph/certs/civetweb.pem
error_log_file=/var/log/radosgw/civetweb.error.log
access_log_file=/var/log/radosgw/civetweb.access.log
request_timeout_ms=30000  num_threads=200&quot;</span>
<span class="token comment">#请求超过30s 报超时    #100线程 每个显示处理一个请求（2000）</span>

<span class="token comment">#https://docs.ceph.com/en/mimic/radosgw/config-ref/</span>
num_threads默认值等于 <span class="token assign-left variable">rgw_thread_pool_size</span><span class="token operator">=</span><span class="token number">100</span>


<span class="token comment">#重启服务</span>
<span class="token punctuation">[</span>root@ceph-mgr2 certs<span class="token punctuation">]</span><span class="token comment"># systemctl restart ceph-radosgw@rgw.ceph-mgr2.service</span>

<span class="token comment">#访问测试:</span>
<span class="token punctuation">[</span>root@ceph-mgr2 certs<span class="token punctuation">]</span><span class="token comment"># curl -k https://172.31.6.108:8443</span>

<span class="token comment">#验证日志</span>
<span class="token function">tail</span> /var/log/radosgw/civetweb/access.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_8-6-测试数据读写" tabindex="-1"><a class="header-anchor" href="#_8-6-测试数据读写" aria-hidden="true">#</a> 8.6 测试数据读写</h2><h4 id="_8-6-1-rgw-server配置" tabindex="-1"><a class="header-anchor" href="#_8-6-1-rgw-server配置" aria-hidden="true">#</a> 8.6.1 RGW Server配置:</h4><p>在实际的生产环境，RGW1和RGW的配置参数是完全一样的.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>jack@ceph-mgr2:-$ <span class="token function">sudo</span> <span class="token function">cat</span> /etc/ceph/ceph.conf
<span class="token punctuation">[</span>global<span class="token punctuation">]</span> 
fsid <span class="token operator">=</span> 1883278f-95fe-4f85-b027-3a6eba444861
public_network <span class="token operator">=</span> <span class="token number">172.31</span>.0.0/21
cluster_network <span class="token operator">=</span> <span class="token number">192.168</span>.0.0/21
mon_initial members <span class="token operator">=</span> ceph-mon1
<span class="token assign-left variable">mon_host</span><span class="token operator">=</span> <span class="token number">172.31</span>.6.101
auth_cluster_required <span class="token operator">=</span> cephx
auth_service_required <span class="token operator">=</span> cephx
auth_client_required <span class="token operator">=</span> cephx



<span class="token punctuation">[</span>client.rgw.ceph-mgr1<span class="token punctuation">]</span>
rgw_host <span class="token operator">=</span> ceph-mgr1
rgw_frontends <span class="token operator">=</span> civetweb port:<span class="token operator">=</span><span class="token number">9900</span>
rgw_dns_name <span class="token operator">=</span> rgw.magedu.net

<span class="token punctuation">[</span>client.rgw.ceph-mgr2<span class="token punctuation">]</span>
rgw_host <span class="token operator">=</span> ceph-mgr2
rgw_frontends <span class="token operator">=</span> civetweb port:<span class="token operator">=</span><span class="token number">9900</span>
rgw_dns_name <span class="token operator">=</span> rgw.magedu.net
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-6-2-创建rgw-账号" tabindex="-1"><a class="header-anchor" href="#_8-6-2-创建rgw-账号" aria-hidden="true">#</a> 8.6.2 创建RGW 账号</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ceph@ceph-deploy:/home/ceph/ceph cluster$ rdosgw admin user create <span class="token parameter variable">--uid</span><span class="token operator">=</span><span class="token string">&quot;user1&quot;</span> --display-name<span class="token operator">=</span><span class="token string">&quot;user1&quot;</span>

<span class="token comment">#创建用户会生成key 是访问SGW存储的凭证</span>

<span class="token string">&quot;keys&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
         <span class="token string">&quot;user&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>use1<span class="token string">&quot;&quot;</span>,
         <span class="token string">&quot;access_key&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;T119RIWTRMMI9BBJEC66&quot;</span>，
         <span class="token string">&quot;secret_key&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;r8kwaYi9hdZJyCKW23hucEUABli 5xOAXSGs8worB&quot;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">]</span>,
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-6-3-安装s3cmd客户端" tabindex="-1"><a class="header-anchor" href="#_8-6-3-安装s3cmd客户端" aria-hidden="true">#</a> 8.6.3 安装s3cmd客户端</h3><p>s3cmd 是一个通过命令行访问ceph RGW实现创建存储同桶、上传、下载以及管理数据到对象存储的命令行客户端工具。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ceph@ceph-deploy:/home/ceph/ceph-cluster$ <span class="token function">sudo</span> <span class="token function">apt-cache</span> madison s3cmd
ceph@ceph-deploy:/home/ceph/ceph-cluster$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> s3cmd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-6-4-配置客户端执行环境" tabindex="-1"><a class="header-anchor" href="#_8-6-4-配置客户端执行环境" aria-hidden="true">#</a> 8.6.4 配置客户端执行环境</h3><h4 id="_8-6-4-1-s3cmd客户端添加域名解析" tabindex="-1"><a class="header-anchor" href="#_8-6-4-1-s3cmd客户端添加域名解析" aria-hidden="true">#</a> 8.6.4.1 s3cmd客户端添加域名解析</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vim</span> /etc/hosts
<span class="token number">127.0</span>.0.1   localhost
<span class="token number">127.0</span>.1.1  ubuntu.example.local  ubuntu

<span class="token number">172.31</span>.6.108 ceph-node3.example.local ceph-node3
<span class="token number">172.31</span>.6.109 ceph-node4.example.local ceph-node4
<span class="token number">172.31</span>.6.201 rgw.magedu.net
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-6-4-2-配置命令执行环境" tabindex="-1"><a class="header-anchor" href="#_8-6-4-2-配置命令执行环境" aria-hidden="true">#</a> 8.6.4.2 配置命令执行环境</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>jack@ceph-deploy:~$ <span class="token function">sudo</span> <span class="token function">su</span> - root
root@ceph-deploy:~<span class="token comment"># s3cmd --help</span>
root@ceph-deploy:~<span class="token comment"># s3cmd --configure</span>

Enter new values or accept defaults <span class="token keyword">in</span> brackets with Enter.
Refer to user manual <span class="token keyword">for</span> detailed description of all options.

Access key and Secret key are your identifiers <span class="token keyword">for</span> Amazon S3. Leave them empty <span class="token keyword">for</span>
using the <span class="token function">env</span> variables.

Access Key: JIJX25OFEJ40JEBECDZV <span class="token comment">#输入用户 access key</span>
Secret Key: vBa23pj4AhGk9GPeSrhL9NLaldShudVfjQ4AC90E <span class="token comment">#输入用户secret key</span>
Default Region <span class="token punctuation">[</span>US<span class="token punctuation">]</span>: <span class="token comment">#region 选项</span>

Use <span class="token string">&quot;s3.amazonaws.com&quot;</span> <span class="token keyword">for</span> S3 Endpoint and not modify it to the target Amazon S3.
S3 Endpoint <span class="token punctuation">[</span>s3.amazonaws.com<span class="token punctuation">]</span>: rgw.magedu.net:9900 <span class="token comment">#RGW 域名</span>
Use  <span class="token string">&quot;%(bucket)s.s3.amazonaws.com&quot;</span> to the target Amazon S3. <span class="token string">&quot;%(bucket)s&quot;</span> and <span class="token string">&quot;%(location)s&quot;</span> vars can be used
<span class="token keyword">if</span> the target S3 system supports dns based buckets.
DNS-style bucket+hostname:port template <span class="token keyword">for</span> accessing a bucket
<span class="token punctuation">[</span>%<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>s.s3.amazonaws.com<span class="token punctuation">]</span>: rgw.magedu.net:9900/%<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span> <span class="token comment">#bucket城名格式</span>
Encryption password is used to protect your files from reading
by unauthorized persons <span class="token keyword">while</span> <span class="token keyword">in</span> transfer to S3
Encryption password <span class="token builtin class-name">:</span> <span class="token comment">#秘钥是否使用密码加密</span>
Path to GPG program <span class="token punctuation">[</span>/usr/bin/gpg<span class="token punctuation">]</span>: <span class="token comment">#使用gpg进行加密（系统自带不需要安装）</span>

<span class="token comment">#是否使用HTTPS</span>
When using secure HTTPS protocol all communication with Amazon S3
servers is protected from 3rd party eavesdropping. This method is
slower than plain HTTP, and can only be proxied with Python <span class="token number">2.7</span> or newe r
Use HTTPS protocol <span class="token punctuation">[</span>Yes<span class="token punctuation">]</span>: No  

<span class="token comment">##是否使用代理服务器</span>
On some networks all internet access must go through a HTTP proxy.
Try setting it here <span class="token keyword">if</span> you can<span class="token string">&#39;t connect to S3 directly
HTTP Proxy server name :

#生成的信息
New settings: 
Access Key: T119RIWTRMMI9BBJEC66
Secret Key: r8kWaY i9hdZJyCKW23hucEUABli5x0AXSGs8worB
Default Region: US
S3 Endpoint: rgw.magedu.net:9900
DNS-style bucket+hostname:port template for accessing a bucket: rgw.magedu.net:9900/%(bucket)
Enc ryption password:
Path to GPG prog ram:/usr/bin/gpg
Use HTTPS protocol: False
HTTP Proxy server name:
HTTP Proxy server port: 0
Test access with supplied credentials? [Y/n]] Y #测试连接
PLease wait, attempting to list all buckets.. .
Success. Your access key and secret key worked fine :-) #如果连接成功就弹出保存配置
Now verifying that encryption works. . .
Not conf igured. Never mind.
Save settings? [y/N] y
Configuration saved to &#39;</span>/root/.s3cfg&#39;

<span class="token comment">#测试命令 </span>
s3cmd la
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-6-5-命令行客户端s3cmd-验证数据上传" tabindex="-1"><a class="header-anchor" href="#_8-6-5-命令行客户端s3cmd-验证数据上传" aria-hidden="true">#</a> 8.6.5 命令行客户端s3cmd 验证数据上传</h3><h4 id="_8-6-5-1-查看帮助信息" tabindex="-1"><a class="header-anchor" href="#_8-6-5-1-查看帮助信息" aria-hidden="true">#</a> 8.6.5.1 查看帮助信息</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>s3cmd <span class="token parameter variable">--help</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_8-6-5-2-创建bucket-以验证权限" tabindex="-1"><a class="header-anchor" href="#_8-6-5-2-创建bucket-以验证权限" aria-hidden="true">#</a> 8.6.5.2 创建bucket 以验证权限</h4><p>存储空间(Bucket) 是用于存储对象(Object) 的容器， 在上传任意类型的Object前，您需要先创建Bucket.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Make bucket
s3cmd mb s3://BUCKET
-------------------------------------------------

root@ceph-deploy:~<span class="token comment"># s3cmd mb s3://mybucket</span>
Bucket <span class="token string">&#39;s3://mybucket/&#39;</span> created

root@ceph-deploy:~<span class="token comment"># s3cmd mb s3://css</span>
Bucket <span class="token string">&#39;s3://css/&#39;</span> created

root@ceph-deploy:~<span class="token comment"># s3cmd mb s3://images</span>
Bucket <span class="token string">&#39;s3://images/&#39;</span> created
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-6-5-3-验证上传数据" tabindex="-1"><a class="header-anchor" href="#_8-6-5-3-验证上传数据" aria-hidden="true">#</a> 8.6.5.3 验证上传数据</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code> Put <span class="token function">file</span> into bucket
       s3cmd put FILE <span class="token punctuation">[</span>FILE<span class="token punctuation">..</span><span class="token punctuation">]</span> s3://BUCKET<span class="token punctuation">[</span>/PREFIX<span class="token punctuation">]</span>

root@ceph-deploy:~<span class="token comment"># wget http://www.magedu.com/wp-content/uploads/2019/07/2019070508503489.png</span>
<span class="token comment">#上传数据</span>


root@ceph-deploy:~<span class="token comment"># s3cmd put 2019070508503489.png s3://mages/</span>
upload: <span class="token string">&#39;2019070508503489.png -&gt; &#39;</span>s3://images/2019070508503489.png<span class="token string">&#39; [1 of 1] 40703 of 40703 100% in  0s  1911.84 kB/s done

root@ceph-deploy:~# s3cmd put 2019070508503489.png s3://images/png/
upload: &#39;</span><span class="token number">2019070508503489</span>.png<span class="token string">&#39; -&gt; &#39;</span>s3://images/png/2019070508503489.png&#39; <span class="token punctuation">[</span><span class="token number">1</span> of <span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">40703</span> of <span class="token number">40703</span> <span class="token number">100</span>% <span class="token keyword">in</span> 2s <span class="token number">16.24</span> kB/s <span class="token keyword">done</span>



<span class="token comment">#验证数据</span>
root@ceph-deploy:~<span class="token comment"># s3cmd ls s3://images/</span>
                      DIR s3://images/png/
<span class="token number">2021</span>-08-26 <span class="token number">13</span>:35    <span class="token number">40703</span> s3://images/2019070508503489.png
root@ceph-deploy:~<span class="token comment"># s3cmd ls s3://images/png/</span>
<span class="token number">2021</span>-08-26 <span class="token number">13</span>:35    <span class="token number">40703</span> s3://images/png/2019070508503489.png

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-6-5-4-验证下载文件" tabindex="-1"><a class="header-anchor" href="#_8-6-5-4-验证下载文件" aria-hidden="true">#</a> 8.6.5.4 验证下载文件</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Get <span class="token function">file</span> from bucket

    s3cmd get s3://BUCKET/OBJECT LOCAL_FILE
------------------------------------------------------------------------
root@ceph-deploy:~<span class="token comment"># s3cmd get s3://images/2019070508503489.png /opt/</span>
download: <span class="token string">&#39;s3://images/2019070508503489.png&#39;</span> -<span class="token operator">&gt;</span> /opt/2019070508503489.png&#39; <span class="token punctuation">[</span>1of <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token number">40703</span> of <span class="token number">40703</span> <span class="token number">100</span>% <span class="token keyword">in</span>  0s  <span class="token number">5.80</span> MB/s <span class="token keyword">done</span>

root@ceph-deploy:~<span class="token comment"># ls /opt/2019070508503489.png</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-6-5-5-删除文件" tabindex="-1"><a class="header-anchor" href="#_8-6-5-5-删除文件" aria-hidden="true">#</a> 8.6.5.5 删除文件</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Delete <span class="token function">file</span> from bucket <span class="token punctuation">(</span>alias <span class="token keyword">for</span> del<span class="token punctuation">)</span>
s3cmd <span class="token function">rm</span> s3://BUCKET/OBJECT
---------------------------------------------------
root@ceph-deploy: ~<span class="token comment"># s3cmd ls s3://images/ #验证当前文件</span>
                      DIR s3://images/png/
<span class="token number">2021</span>-08-26 <span class="token number">13</span>:35  <span class="token number">40703</span>   s3://images/2019070508503489.png



root@ceph-deploy: ~<span class="token comment"># s3cmd rm s3://images/2019070508503489.png #删除文件</span>
delete: <span class="token string">&#39;s3://images/2019070508503489.png&#39;</span>


root@ceph-deploy:~<span class="token comment"># s3cmd ls s3://images/ #验证是否被删除</span>
                      DIR s3://images/png/
<span class="token comment">#查看存储池pg</span>
ceph pg ls-by-pool default.rgw.buckets.data <span class="token function">awk</span> <span class="token string">&#39;{print $1, $2, $15}&#39;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: xinxincn0506@outlook.com">ryanxin7</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/ceph/log/7.%20Ceph-FS%E4%BD%BF%E7%94%A8.html" class="nav-link prev" aria-label="7.Ceph FS"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->7.Ceph FS</div></a><a href="/ceph/log/9.%20ceph-crush%E8%BF%9B%E9%98%B6.html" class="nav-link next" aria-label="9.Ceph crush算法进阶"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">9.Ceph crush算法进阶<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Ryan's Notebook</div><div class="copyright">Copyright © 2023 Ryan</div></footer></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-982fbdc9.js" defer></script>
  </body>
</html>
