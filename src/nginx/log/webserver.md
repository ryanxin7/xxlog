---
title: HTTP 协议与网站原理介绍
intro: 基础知识
featured_image: ss8.jpg
tags:
  - 网络协议
  - Http
  - Linux 服务
categories: linux
date: 2019-11-22 21:45:01
---

**当用户访问一个网站时，都发生了事情？**

用户在浏览器输入网址信息点击回车 [ryanxin.com](www.ryanxin.com)
客户端计算机完成域名的解析过程(DNS)后直接访问相应网站服务器建立TCP三次握手过程多次发送HTTP请求报文，服务端响应客户端请求多次回复HTTP响应报文，这时用户使用浏览器可以看到网站页面，用户关掉网页结束访问网站的过程，客户端计算机完成TCP四次挥手过程，客户端与服务端断开连接。

<br>

## 1. DNS迭代查询

利用DNS服务，将输入的域名解析为相应的IP地址。

① 本地主机输入域名后，会查询本地缓存信息和本地 hosts。
② 本地主机会向远程LDNS服务器，发送递归查询请求。
③ LDNS是网卡配置的DNS服务（223.5.5.5 114.114.114.114）。
④ LDNS服务器会向根域名服务器发出请求，将请求响应给LDNS服务器。
⑤ LDNS服务器会向顶级域名服务器发出请求，将请求响应给LDNS服务器。
⑥ LDNS服务器会向二级域名服务器发出请求，将请求响应给LDNS服务器。
⑦ LDNS服务器收到二级域名服务器响应过来的信息（解析记录），进行本地缓存将解析记录发送给本地主机。
⑧ 本地主机收到LDNS服务器的响应信息，也会将解析记录进行缓存，利用IP地址访问网站服务器。


<br>

## 2. HTTP通讯原理说明

① 客户端与服务端建立连接
② 利用已知的IP地址，进行网络三次握手连接建立
③ 本地主机客户端向网站服务端，发出请求 http请求数据包（http请求报文）
④ 网站服务端向本地主机客户端，回复响应 http响应数据包（http响应报文）
⑤ 完成网络四次挥手断开过程

## 3.HTTP协议的数据包

HTTP请求报文

**1. 请求行**	 

①请求方法: 	Get		--读/看	---获取/拿过来  post	-- 写/提交
②请求信息: 	index.html(首页文件)  oldboy.jpg 
③请求协议:  http 1.1	 

HTTP: 1.0	TCP短连接  
HTTP: 1.1   TCP长连接
HTTP: 2.0   TCP长连接优化  提高用户并发(同时)访问的效率 


2. **请求头**	  
请求主机信息


3. 空行
用于区分头部和主体


4. **请求主体**
使用get方法时, 没有请求主体信息
使用post方法时,具有请求主体内容

<br>

### 3.2 HTTP响应报文

<br>

1. **起始行** 

使用的什么服务 ?
状态码信息  访问请求是成功响应还是失败响应？
面试时可能问的问题: 写出几种常见的状态码? 例如： 301 302 404 500 403 200  

<br>

2. **响应头部**

字符集 UTF-8
文件类型
时间信息

<br>

3.  **空行**

4.  **响应主体**

![linux05-1](https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxlinux05-1.png)

<br>


## 4.常见的状态码

<br>

| 状态代码                   | 详细描述说明                                                 |
| -------------------------- | ------------------------------------------------------------ |
| 200  -  OK                 | 服务器成功返回网页，这是成功的 HTTP 请求返回的标准状态码     |
| 301 - Moved Permanently    | 永久跳转，所请求的网页将永久跳转到被设定的新位置             |
| 403 - Forbidden            | 禁止访问，虽然这个请求是合法的，但是服务器端因为匹配了预先设置的规则而拒绝响应客户端的请求，此类问题一般为服务器或服务权限配置不当所致。 |
| 404 - Not Found            | 服务器找不到客户端请求的指定页面，可能是客户端请求了服务器上不存在的资源所致。 |
| 500  Internal Server Error | 内部服务器错误，服务器遇到了意料不到的情况，不能完成客户端的请求。这是一个笼统的报错，一般为服务器的设置或内部程序问题导致。例如：SElinux 开启，而又没有为 HTTP 设置规则许可，此时客户端访问得到状态码就是500 |
| 502 - Bad Gateway （重点） | 坏的网关，一般是代理服务器请求后端服务时，后端服务器不可用或没有完成响应网关服务器。这通常为反向代理服务器下面的节点出现问题所致。反向代理服务器无法与后面的 Web 服务节点服务器建立关系 |
| 503 - Service Unavailable  | 服务当前不可用，可能是服务器超载或停机维护导致的。或者是反向代理服务器后面没有可以提供服务的节点 |
| 504 - Gateway Timeout      | 网关超时，一般是网关代理服务器请求后端服务时，后端服务没有在特定的时间内完成处理请求。多数是服务器过载导致没有在指定的时间内返回数据给前端代理服务器 |

<br>

## 5. HTTP协议资源信息

<br>

URL:  全称为**Uniform Resource Location**，中文翻译为统一资源定位符。

URI:  全称为**Uniform Resource Identifier**，中文翻译为统一资源标识符。

​	

**举例：**  

URL : [docs.ansible.com]()  

URI : [/ansible/latest/user_guide/playbooks_reuse_roles.html]( /ansible/latest/user_guide/playbooks_reuse_roles.html)

​      <br>

<br>

### 5.1 网站页面静态资源

<br>

::: tip 特点说明

要什么给我什么,  `xin.jpg  index.html` 标准文件后缀

 

- 网页内容是固定不变的，因此，容易被搜索引擎收录（容易被用户找到）

- 因为网页没有数据库的支持，所以在网站制作和维护方面的工作量较大，当网站信息量很大时，完全依靠静态网页比较困难

- 网页的交互性较差，在程序的功能实现方面有较大的限制

- 当客户端向服务器请求数据时，服务器会直接从磁盘文件系统上返回数据（不做任何解析）。



:::

<br>

### 5.2 网站页面动态资源

<br>

::: tip 特点说明

要什么信息,需要进行查询数据库进行解析后发送给客户端。

**例如：查看班级人员信息表**

班级  人名  年龄  学历

sz-01  张三  18   高中  ---> 数据库中 xin=123 <--- post  提交就自动存到数据库中

sz-01  李四  20   大专	



- 代码信息直接调用数据库的内容

- 采用动态网页技术的网站可以实现更多的功能，如用户注册、用户登录、在线调查、

- 投票、用户管理、订单处理、发博文等。

- 动态资源页面会出现 "`?`" "`&`", 不便于被搜索引擎收录

- 接收到用户请求,需要让动态服务和数据库服务进行处理

:::

<br>

### 5.3 伪静态资源

 <br>

实际上就是把动态页面伪装成静态页面

-  可以便于搜索引擎进行收录

- 有数据库服务支持,实现网页交互功能